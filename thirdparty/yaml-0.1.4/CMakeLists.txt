PROJECT(libyaml C)

SET(YAML_VERSION_MAJOR 0)
SET(YAML_VERSION_MINOR 1)
SET(YAML_VERSION_PATCH 4)

SET(YAML_VERSION_STRING "${YAML_VERSION_MAJOR}.${YAML_VERSION_MINOR}.${YAML_VERSION_PATCH}")

INCLUDE_DIRECTORIES(include)

ADD_DEFINITIONS(-DYAML_VERSION_MAJOR=${YAML_VERSION_MAJOR})
ADD_DEFINITIONS(-DYAML_VERSION_MINOR=${YAML_VERSION_MINOR})
ADD_DEFINITIONS(-DYAML_VERSION_PATCH=${YAML_VERSION_PATCH})
ADD_DEFINITIONS(-DYAML_VERSION_STRING=\"${YAML_VERSION_STRING}\")

FILE(GLOB SRC src/*.c include/*.h)
ADD_LIBRARY(yaml ${SRC})

IF(MINGW)
  GET_FILENAME_COMPONENT(MINGW_BIN "${CMAKE_C_COMPILER}" PATH)
  GET_FILENAME_COMPONENT(MINGW_ROOT "${MINGW_BIN}" PATH CACHE)
  SET(LIBYAML_INSTALL_PREFIX "${MINGW_ROOT}" CACHE PATH "MinGW default install path")
ELSE(MINGW)
  SET(LIBYAML_INSTALL_PREFIX ${CMAKE_INSTALL_PREFIX} CACHE PATH "default install path")
ENDIF(MINGW)
SET(CMAKE_INSTALL_PREFIX ${LIBYAML_INSTALL_PREFIX} CACHE INTERNAL "")

ADD_DEFINITIONS(-DYAML_DECLARE_STATIC -fPIC)
    

INSTALL(TARGETS yaml DESTINATION lib)
INSTALL(FILES "include/yaml.h" DESTINATION include)
